<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>MD. Tamim - Portfolio</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        /* --- SYSTEM CORE --- */
        :root {
            --system-font: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            --wallpaper: url('https://images.unsplash.com/photo-1493246507139-91e8fad9978e?ixlib=rb-4.0.3&auto=format&fit=crop&w=2940&q=80');
        }

        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            font-family: var(--system-font);
            user-select: none;
            -webkit-user-select: none;
            background-color: #000;
            height: 100vh;
            width: 100vw;
        }

        /* --- WALLPAPER --- */
        .bg-wallpaper {
            background-image: var(--wallpaper);
            background-size: cover;
            background-position: center;
        }

        /* --- UTILS --- */
        .hidden { display: none !important; }
        .glass {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* --- LOADING BAR --- */
        .loading-bar {
            width: 200px;
            height: 6px;
            background: #333;
            border-radius: 10px;
            margin-top: 40px;
            overflow: hidden;
        }
        
        .loading-progress {
            height: 100%;
            width: 0%;
            background: #fff;
            transition: width 2.5s ease-out;
            border-radius: 10px;
        }

        /* =========================================
           MACOS STYLES (Desktop)
           ========================================= */
        #macos-root {
            position: fixed;
            inset: 0;
            z-index: 10;
        }

        .macos-dock-container {
            position: absolute;
            bottom: 20px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: center;
            z-index: 6000;
            pointer-events: none;
        }

        .macos-dock {
            background: rgba(255, 255, 255, 0.4);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 24px;
            padding: 12px;
            display: flex;
            gap: 16px;
            align-items: end;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            pointer-events: auto;
            transition: all 0.2s ease;
        }

        .macos-icon {
            width: 55px;
            height: 55px;
            border-radius: 14px;
            transition: transform 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            background: linear-gradient(180deg, #ffffff 0%, #f0f0f0 100%);
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }

        .macos-icon:hover { transform: scale(1.2) translateY(-15px); margin: 0 8px; z-index: 10; }

        .macos-dot {
            position: absolute;
            bottom: -8px;
            width: 4px;
            height: 4px;
            background: rgba(0,0,0,0.6);
            border-radius: 50%;
            opacity: 0;
        }
        .macos-dot.active { opacity: 1; }

        .window {
            position: absolute;
            background: #fbfbfb;
            border-radius: 12px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            animation: openWindow 0.25s cubic-bezier(0.16, 1, 0.3, 1) forwards;
            resize: both;
            border: 1px solid rgba(0,0,0,0.1);
        }
        @keyframes openWindow { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }

        /* =========================================
           iOS STYLES (Mobile)
           ========================================= */
        #ios-root {
            position: fixed;
            inset: 0;
            z-index: 20;
            color: white;
            overflow: hidden;
        }

        .ios-icon {
            width: 60px;
            height: 60px;
            border-radius: 14px;
            background: linear-gradient(180deg, #ffffff 0%, #e5e5e5 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            position: relative;
        }
        
        .ios-icon:active { filter: brightness(0.8); transform: scale(0.95); transition: 0.1s; }

        .ios-dock {
            position: absolute;
            bottom: 20px;
            left: 16px;
            right: 16px;
            height: 90px;
            background: rgba(255, 255, 255, 0.25);
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
            border-radius: 30px;
            display: flex;
            align-items: center;
            justify-content: space-evenly;
            padding-bottom: 5px;
        }

        .ios-app-window {
            position: fixed;
            inset: 0;
            background: #fff;
            z-index: 9000;
            transform: translateY(100%);
            transition: transform 0.4s cubic-bezier(0.32, 0.72, 0, 1);
            display: flex;
            flex-direction: column;
        }

        .ios-app-window.open { transform: translateY(0); }

        /* --- Common App Colors --- */
        .icon-about { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white; }
        .icon-projects { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
        .icon-links { background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); color: white; }
        .icon-contact { background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); color: white; }

        /* --- Scrollbar --- */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-thumb { background: #ccc; border-radius: 3px; }
    </style>
</head>
<body class="bg-wallpaper">

    <!-- APPLE LOGO SVG DEFINITION -->
    <svg style="display: none;">
        <symbol id="icon-apple-logo" viewBox="0 0 384 512">
            <path fill="currentColor" d="M318.7 268.7c-.2-36.7 16.4-64.4 50-84.8-18.8-26.9-47.2-41.7-84.7-44.6-35.5-2.8-74.3 20.7-88.5 20.7-15 0-49.4-19.7-76.4-19.7C63.3 141.2 4 184.8 4 273.5q0 39.3 14.4 81.2c12.8 36.7 59 126.7 107.2 125.2 25.2-.6 43-17.9 75.8-17.9 31.8 0 48.3 17.9 76.4 17.9 48.6-.7 90.4-82.5 102.6-119.3-65.2-30.7-61.7-90-61.7-91.9zm-56.6-164.2c27.3-32.4 24.8-61.9 24-72.5-24.1 1.4-52 16.4-67.9 34.9-17.5 19.8-27.8 44.3-25.6 71.9 26.1 2 52.3-11.4 69.5-34.3z"/>
        </symbol>
    </svg>

    <!-- BOOT SCREEN -->
    <div id="boot-screen" style="position:fixed; inset:0; background:#000; z-index:99999; display:flex; flex-direction:column; align-items:center; justify-content:center; transition:opacity 0.8s;">
        <!-- Half-eaten apple -->
        <svg width="80" height="80" style="color:white;"><use href="#icon-apple-logo"></use></svg>
        <div class="loading-bar">
            <div class="loading-progress" id="boot-progress"></div>
        </div>
    </div>

    <!-- =========================
         MACOS (DESKTOP/TAB)
         ========================= -->
    <div id="macos-root" style="display:none; opacity:0; transition:opacity 1s;">
        <!-- Menu Bar -->
        <div class="h-[30px] bg-white/30 backdrop-blur-xl flex items-center justify-between px-5 text-sm font-medium relative z-50 text-black">
            <div class="flex items-center gap-4">
                <svg width="14" height="14" style="color:black;"><use href="#icon-apple-logo"></use></svg>
                <span id="macos-active-app" class="font-bold">Finder</span>
                <div class="hidden lg:flex gap-4 font-normal text-gray-800">
                    <span>File</span><span>Edit</span><span>View</span><span>Go</span><span>Window</span><span>Help</span>
                </div>
            </div>
            <div class="flex items-center gap-4 text-gray-800">
                <i data-lucide="wifi" width="16"></i>
                <i data-lucide="search" width="16"></i>
                <i data-lucide="sliders-horizontal" width="16"></i>
                <span id="macos-clock">Mon Jun 22 9:41 AM</span>
            </div>
        </div>

        <!-- Windows Area -->
        <div id="macos-windows-container"></div>

        <!-- Dock -->
        <div class="macos-dock-container">
            <div class="macos-dock">
                <div class="macos-icon icon-about" onclick="openApp('about')" title="About Me">
                    <i data-lucide="user-circle-2" width="32"></i>
                    <div class="macos-dot" id="dot-about"></div>
                </div>
                <div class="macos-icon icon-projects" onclick="openApp('projects')" title="Projects">
                    <i data-lucide="briefcase" width="30"></i>
                    <div class="macos-dot" id="dot-projects"></div>
                </div>
                <div class="macos-icon icon-links" onclick="openApp('links')" title="Links">
                    <i data-lucide="globe" width="30"></i>
                    <div class="macos-dot" id="dot-links"></div>
                </div>
                <div class="macos-icon icon-contact" onclick="openApp('contact')" title="Contact">
                    <i data-lucide="mail" width="30"></i>
                    <div class="macos-dot" id="dot-contact"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- =========================
         iOS (PHONE)
         ========================= -->
    <div id="ios-root" style="display:none; opacity:0; transition:opacity 1s;">
        
        <!-- Status Bar -->
        <div class="absolute top-0 w-full h-12 flex justify-between items-center px-6 text-white text-sm font-semibold z-10 pt-2">
            <span id="ios-clock">9:41</span>
            <div class="flex gap-2 items-center">
                <i data-lucide="signal" width="14"></i>
                <i data-lucide="wifi" width="14"></i>
                <i data-lucide="battery-full" width="18"></i>
            </div>
        </div>
        
        <!-- Dock (The main apps) -->
        <div class="ios-dock">
            <div class="ios-app-icon-container" onclick="openApp('about')">
                <div class="ios-icon icon-about"><i data-lucide="user-circle-2" width="28"></i></div>
            </div>
            <div class="ios-app-icon-container" onclick="openApp('projects')">
                <div class="ios-icon icon-projects"><i data-lucide="briefcase" width="26"></i></div>
            </div>
            <div class="ios-app-icon-container" onclick="openApp('links')">
                <div class="ios-icon icon-links"><i data-lucide="globe" width="26"></i></div>
            </div>
            <div class="ios-app-icon-container" onclick="openApp('contact')">
                <div class="ios-icon icon-contact"><i data-lucide="mail" width="26"></i></div>
            </div>
        </div>

        <!-- Full Screen App Overlay Container -->
        <div id="ios-app-overlay" class="ios-app-window">
            <!-- Header -->
            <div class="h-24 bg-gray-100 flex items-end pb-3 px-4 border-b border-gray-300 relative">
                <button onclick="closeIOSApp()" class="absolute left-4 bottom-3 flex items-center text-blue-500 font-medium active:opacity-50">
                    <i data-lucide="chevron-left" width="24"></i> Back
                </button>
                <div class="w-full text-center font-bold text-lg text-black" id="ios-app-title">Title</div>
            </div>
            <!-- Content -->
            <div id="ios-app-content" class="flex-1 overflow-y-auto bg-white text-black pb-10">
                <!-- Injected content -->
            </div>
        </div>
    </div>

    <!-- Login Overlay -->
    <div id="login-overlay" class="fixed inset-0 z-[8000] bg-wallpaper bg-cover bg-center flex flex-col items-center justify-center transition-opacity duration-700 hidden">
        <div class="glass p-8 rounded-3xl flex flex-col items-center gap-6 w-80 md:w-96 shadow-2xl">
            <img src="https://i.postimg.cc/nL6Rhh0d/xc008q.jpg" class="w-24 h-24 rounded-full border-4 border-white/20 object-cover shadow-lg">
            <div class="text-center text-white">
                <h2 class="text-2xl font-bold">MD. Tamim</h2>
                <p class="opacity-70 text-sm">Tap or Enter to Login</p>
            </div>
            <button onclick="performLogin()" class="w-12 h-12 bg-white/20 rounded-full flex items-center justify-center text-white hover:bg-white/30 transition backdrop-blur-md">
                <i data-lucide="arrow-right" width="20"></i>
            </button>
        </div>
    </div>

    <script>
        // --- DATA SOURCE (Shared content) ---
        const appsData = {
            about: {
                title: "About Me",
                width: 600, height: 500,
                color: "bg-blue-50",
                content: `
                    <div class="flex flex-col h-full bg-white">
                        <div class="relative h-48 bg-gradient-to-r from-cyan-500 to-blue-500 flex items-end p-6">
                            <div class="absolute -bottom-10 left-6 w-24 h-24 rounded-full border-4 border-white shadow-lg overflow-hidden bg-white">
                                <img src="https://i.postimg.cc/nL6Rhh0d/xc008q.jpg" class="w-full h-full object-cover">
                            </div>
                            <div class="ml-28 mb-1 text-white">
                                <h1 class="text-2xl font-bold">MD. Tamim</h1>
                                <p class="text-white/80 text-sm">Medical Student @ Sher-E-Bangla</p>
                            </div>
                        </div>
                        <div class="p-6 pt-12 overflow-y-auto">
                            <p class="text-lg leading-relaxed mb-4 text-gray-700">
                                Assalamu Alaikum! I'm a medical student (54th Batch) passionate about teaching. Founder of Medishark.
                            </p>
                            <div class="space-y-4">
                                <div class="bg-blue-50 p-4 rounded-xl border border-blue-100">
                                    <h3 class="font-bold text-blue-800 mb-2 flex items-center gap-2"><i data-lucide="microscope" width="16"></i> Academic Interests</h3>
                                    <ul class="list-disc list-inside text-sm text-gray-700 space-y-1">
                                        <li>Clinical Biochemistry</li>
                                        <li>Endocrinology</li>
                                        <li>Biophysics</li>
                                    </ul>
                                </div>
                                <div class="bg-orange-50 p-4 rounded-xl border border-orange-100">
                                    <h3 class="font-bold text-orange-800 mb-2 flex items-center gap-2"><i data-lucide="coffee" width="16"></i> Personal</h3>
                                    <ul class="list-disc list-inside text-sm text-gray-700 space-y-1">
                                        <li>Foodie (Kacchi Biryani üçõ)</li>
                                        <li>F1 Fan (Red Bull Racing üèéÔ∏è)</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                `
            },
            projects: {
                title: "Projects",
                width: 700, height: 500,
                color: "bg-purple-50",
                content: `
                    <div class="p-6 bg-gray-50 h-full overflow-y-auto">
                        <h2 class="text-2xl font-bold text-gray-800 mb-6">My Projects</h2>
                        <div class="grid gap-4">
                            <!-- Medishark -->
                            <div class="bg-white p-5 rounded-2xl shadow-sm border border-gray-200">
                                <div class="flex items-center gap-3 mb-2">
                                    <div class="p-2 bg-blue-100 rounded-lg text-blue-600"><i data-lucide="zap" width="20"></i></div>
                                    <h3 class="text-lg font-bold text-gray-900">Medishark</h3>
                                </div>
                                <p class="text-sm text-gray-600 leading-relaxed">
                                    A digital learning platform I founded to simplify complex medical concepts.
                                </p>
                            </div>
                            <!-- Respiratory -->
                            <div class="bg-white p-5 rounded-2xl shadow-sm border border-gray-200">
                                <div class="flex items-center gap-3 mb-2">
                                    <div class="p-2 bg-teal-100 rounded-lg text-teal-600"><i data-lucide="activity" width="20"></i></div>
                                    <h3 class="text-lg font-bold text-gray-900">Respiratory Physiology</h3>
                                </div>
                                <p class="text-sm text-gray-600 mb-3">An in-depth course on respiratory mechanics and gas exchange.</p>
                                <a href="https://medisharkbd.com/course/respiratory_physiology" target="_blank" class="text-xs font-bold text-teal-600 bg-teal-50 px-3 py-1.5 rounded-full inline-block">View Course</a>
                            </div>
                            <!-- Anatomy -->
                            <div class="bg-white p-5 rounded-2xl shadow-sm border border-gray-200">
                                <div class="flex items-center gap-3 mb-2">
                                    <div class="p-2 bg-purple-100 rounded-lg text-purple-600"><i data-lucide="box" width="20"></i></div>
                                    <h3 class="text-lg font-bold text-gray-900">Anatomy Course</h3>
                                </div>
                                <p class="text-sm text-gray-600 mb-3">Teaching anatomy from the basics using 3D visualization.</p>
                                <a href="https://medisharkbd.com/course/1st_year_1st_term_combo" target="_blank" class="text-xs font-bold text-purple-600 bg-purple-50 px-3 py-1.5 rounded-full inline-block">View Course</a>
                            </div>
                        </div>
                    </div>
                `
            },
            links: {
                title: "Links",
                // Increased height from 400 to 480 to fit all content comfortably
                width: 500, height: 480,
                color: "bg-green-50",
                // Added overflow-y-auto to fix the missing content issue on desktop
                content: `
                    <div class="p-6 bg-white h-full flex flex-col overflow-y-auto">
                         <h2 class="text-xl font-bold text-center mb-6 text-gray-800">Quick Access</h2>
                         <div class="space-y-4">
                            <!-- Demo Classes -->
                            <a href="https://youtube.com/@medisharkbd?si=5zOr0oXz2bieIWtZ" target="_blank" class="flex items-center p-4 bg-red-50 rounded-xl border border-red-100 hover:bg-red-100 transition">
                                <div class="w-10 h-10 bg-red-500 rounded-full flex items-center justify-center text-white"><i data-lucide="youtube" width="20"></i></div>
                                <div class="ml-4 flex-1">
                                    <div class="font-bold text-gray-800">Demo Classes</div>
                                    <div class="text-xs text-gray-500">@medisharkbd</div>
                                </div>
                                <i data-lucide="external-link" width="16" class="text-gray-400"></i>
                            </a>
                            <!-- My Channel -->
                            <a href="https://youtube.com/@studywithtamim?si=EszZKF-j-TerEjlK" target="_blank" class="flex items-center p-4 bg-gray-50 rounded-xl border border-gray-200 hover:bg-gray-100 transition">
                                <div class="w-10 h-10 bg-gray-800 rounded-full flex items-center justify-center text-white"><i data-lucide="youtube" width="20"></i></div>
                                <div class="ml-4 flex-1">
                                    <div class="font-bold text-gray-800">My Channel</div>
                                    <div class="text-xs text-gray-500">@studywithtamim</div>
                                </div>
                                <i data-lucide="external-link" width="16" class="text-gray-400"></i>
                            </a>
                            <!-- Physiology Course -->
                            <a href="https://medisharkbd.com/course/respiratory_physiology" target="_blank" class="flex items-center p-4 bg-teal-50 rounded-xl border border-teal-100 hover:bg-teal-100 transition">
                                <div class="w-10 h-10 bg-teal-500 rounded-full flex items-center justify-center text-white"><i data-lucide="activity" width="20"></i></div>
                                <div class="ml-4 flex-1">
                                    <div class="font-bold text-gray-800">Physiology Course</div>
                                    <div class="text-xs text-gray-500">medisharkbd.com</div>
                                </div>
                                <i data-lucide="external-link" width="16" class="text-gray-400"></i>
                            </a>
                            <!-- Anatomy Course -->
                            <a href="https://medisharkbd.com/course/1st_year_1st_term_combo" target="_blank" class="flex items-center p-4 bg-purple-50 rounded-xl border border-purple-100 hover:bg-purple-100 transition">
                                <div class="w-10 h-10 bg-purple-500 rounded-full flex items-center justify-center text-white"><i data-lucide="box" width="20"></i></div>
                                <div class="ml-4 flex-1">
                                    <div class="font-bold text-gray-800">Anatomy Course</div>
                                    <div class="text-xs text-gray-500">medisharkbd.com</div>
                                </div>
                                <i data-lucide="external-link" width="16" class="text-gray-400"></i>
                            </a>
                         </div>
                    </div>
                `
            },
            contact: {
                title: "Contact",
                width: 450, height: 350,
                color: "bg-orange-50",
                content: `
                    <div class="h-full bg-gradient-to-b from-orange-50 to-white p-8 flex flex-col items-center justify-center text-center">
                        <div class="w-20 h-20 bg-orange-100 rounded-full flex items-center justify-center mb-6">
                            <i data-lucide="mail-open" width="40" class="text-orange-500"></i>
                        </div>
                        <h2 class="text-2xl font-bold text-gray-800 mb-2">Get In Touch</h2>
                        <p class="text-gray-500 mb-8 max-w-xs text-sm">
                            Want to collaborate, learn, or just chat about physiology or F1?
                        </p>
                        <a href="mailto:tamimtanvir10@gmail.com" class="bg-black text-white px-8 py-3 rounded-full font-medium shadow-lg hover:shadow-xl hover:scale-105 transition flex items-center gap-2">
                            <i data-lucide="send" width="16"></i>
                            Email Me
                        </a>
                    </div>
                `
            }
        };

        // --- SYSTEM CORE ---
        let zIndexCounter = 100;
        let isLoggedIn = false;
        
        // Define Mobile Breakpoint
        const isMobile = () => window.innerWidth < 768; 

        // Boot Sequence
        window.onload = () => {
            lucide.createIcons();
            
            // Start Progress Bar
            setTimeout(() => {
                document.getElementById('boot-progress').style.width = "100%";
            }, 100);

            // Finish Boot
            setTimeout(() => {
                document.getElementById('boot-screen').style.opacity = 0;
                setTimeout(() => {
                    document.getElementById('boot-screen').classList.add('hidden');
                    document.getElementById('login-overlay').classList.remove('hidden');
                    setTimeout(() => document.getElementById('login-overlay').style.opacity = 1, 50);
                }, 800);
            }, 2500);
            
            updateClocks();
            setInterval(updateClocks, 1000);
            
            // Layout Checker
            window.addEventListener('resize', updateLayoutVisibility);
        };

        function updateClocks() {
            const now = new Date();
            // macOS format
            const macOptions = { weekday: 'short', month: 'short', day: 'numeric', hour: 'numeric', minute: '2-digit' };
            const macTime = now.toLocaleString('en-US', macOptions).replace(',', '');
            const macClock = document.getElementById('macos-clock');
            if(macClock) macClock.innerText = macTime;

            // iOS format
            const iosTime = now.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit', hour12: true }).replace(/ AM| PM/, '');
            const iosClock = document.getElementById('ios-clock');
            if(iosClock) iosClock.innerText = iosTime;
        }

        // --- LAYOUT SWITCHER ---
        function updateLayoutVisibility() {
            if (!isLoggedIn) return; // Only switch if logged in
            
            const macRoot = document.getElementById('macos-root');
            const iosRoot = document.getElementById('ios-root');

            if (isMobile()) {
                // Show iOS, Hide Mac
                macRoot.style.display = 'none';
                macRoot.style.opacity = 0;
                
                iosRoot.style.display = 'block';
                setTimeout(() => iosRoot.style.opacity = 1, 50);
            } else {
                // Show Mac, Hide iOS
                iosRoot.style.display = 'none';
                iosRoot.style.opacity = 0;
                
                macRoot.style.display = 'block';
                setTimeout(() => macRoot.style.opacity = 1, 50);
            }
        }

        // Login Logic
        function performLogin() {
            const login = document.getElementById('login-overlay');
            login.style.opacity = 0;
            isLoggedIn = true;
            
            setTimeout(() => {
                login.classList.add('hidden');
                updateLayoutVisibility(); // Initialize correct layout
            }, 700);
        }

        // --- UNIFIED APP OPENER ---
        function openApp(appId) {
            const app = appsData[appId];
            if (!app) return;

            if (isMobile()) {
                // iOS Mode: Open Full Screen Overlay
                const overlay = document.getElementById('ios-app-overlay');
                document.getElementById('ios-app-title').innerText = app.title;
                document.getElementById('ios-app-content').innerHTML = app.content;
                overlay.classList.add('open');
                lucide.createIcons();
            } else {
                // macOS Mode: Open Window
                if (document.getElementById(`win-${appId}`)) {
                    focusWindow(appId);
                    return;
                }

                // Dot indicator
                const dot = document.getElementById(`dot-${appId}`);
                if (dot) dot.classList.add('active');

                // Create Window
                const win = document.createElement('div');
                win.id = `win-${appId}`;
                win.className = 'window';
                win.style.width = app.width + 'px';
                win.style.height = app.height + 'px';
                win.style.zIndex = ++zIndexCounter;
                
                // Random position logic
                const leftPos = Math.max(50, (window.innerWidth / 2) - (app.width / 2) + (Math.random() * 40 - 20));
                const topPos = Math.max(50, (window.innerHeight / 2) - (app.height / 2) + (Math.random() * 40 - 20));
                
                win.style.left = leftPos + 'px';
                win.style.top = topPos + 'px';

                // Header color
                let headerBg = "#f0f0f0";
                if(appId === 'about') headerBg = "#e3f2fd";
                if(appId === 'projects') headerBg = "#f3e5f5";
                if(appId === 'links') headerBg = "#e8f5e9";
                if(appId === 'contact') headerBg = "#fff3e0";

                win.innerHTML = `
                    <div class="h-11 border-b border-gray-300 flex items-center px-4 select-none" style="background:${headerBg}" onmousedown="startDrag(event, '${appId}')" ontouchstart="startDrag(event, '${appId}')">
                        <div class="flex gap-2 mr-4">
                            <div class="win-btn bg-red-400 w-3 h-3 rounded-full border border-black/10 hover:brightness-90 cursor-pointer flex items-center justify-center" onclick="closeWindow('${appId}')"><span class="hidden hover:block text-[8px] font-bold opacity-50">√ó</span></div>
                            <div class="win-btn bg-yellow-400 w-3 h-3 rounded-full border border-black/10 cursor-pointer"></div>
                            <div class="win-btn bg-green-400 w-3 h-3 rounded-full border border-black/10 cursor-pointer"></div>
                        </div>
                        <div class="flex-1 flex justify-center text-sm font-semibold text-gray-700 pointer-events-none">${app.title}</div>
                        <div class="w-12"></div>
                    </div>
                    <div class="flex-1 bg-white overflow-hidden relative" onclick="focusWindow('${appId}')">
                        ${app.content}
                    </div>
                `;

                document.getElementById('macos-windows-container').appendChild(win);
                lucide.createIcons();
                updateMacMenuBar(app.title);
            }
        }

        // --- iOS Logic ---
        function closeIOSApp() {
            document.getElementById('ios-app-overlay').classList.remove('open');
        }

        // --- macOS Logic ---
        function closeWindow(appId) {
            const win = document.getElementById(`win-${appId}`);
            if (win) {
                win.style.opacity = 0;
                win.style.transform = "scale(0.9)";
                setTimeout(() => {
                    win.remove();
                    const dot = document.getElementById(`dot-${appId}`);
                    if (dot) dot.classList.remove('active');
                    updateMacMenuBar('Finder');
                }, 200);
            }
        }

        function focusWindow(appId) {
            const win = document.getElementById(`win-${appId}`);
            if(win) {
                win.style.zIndex = ++zIndexCounter;
                updateMacMenuBar(appsData[appId].title);
            }
        }

        function updateMacMenuBar(title) {
            const el = document.getElementById('macos-active-app');
            if(el) el.innerText = title;
        }

        // --- Dragging Logic (macOS only) ---
        let isDragging = false;
        let dragOffset = { x: 0, y: 0 };
        let dragWin = null;

        function startDrag(e, appId) {
            // Check for buttons
            if (e.target.closest('.win-btn')) return;
            
            // Normalize event
            const evt = e.touches ? e.touches[0] : e;
            
            isDragging = true;
            dragWin = document.getElementById(`win-${appId}`);
            focusWindow(appId);
            
            const rect = dragWin.getBoundingClientRect();
            dragOffset.x = evt.clientX - rect.left;
            dragOffset.y = evt.clientY - rect.top;
        }

        function onDragMove(e) {
            if (!isDragging || !dragWin) return;
            
            // Normalize event
            const evt = e.touches ? e.touches[0] : e;
            
            // Prevent scrolling on touch
            if(e.cancelable) e.preventDefault();

            let newX = evt.clientX - dragOffset.x;
            let newY = evt.clientY - dragOffset.y;
            
            if (newY < 30) newY = 30;

            dragWin.style.left = newX + 'px';
            dragWin.style.top = newY + 'px';
        }

        function onDragEnd() {
            isDragging = false;
            dragWin = null;
        }

        window.addEventListener('mousemove', onDragMove);
        window.addEventListener('touchmove', onDragMove, { passive: false });
        window.addEventListener('mouseup', onDragEnd);
        window.addEventListener('touchend', onDragEnd);

    </script>
</body>
</html>